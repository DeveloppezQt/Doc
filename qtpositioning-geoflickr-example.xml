<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en">
<db:info>
<db:title>GeoFlickr (QML)</db:title>
<db:productname>QtPositioning</db:productname>
<db:edition>Qt 5.8.0 Reference Documentation</db:edition>
<db:titleabbrev>Qt Positioning Reference Documentation</db:titleabbrev>
<db:abstract>
<db:para>The GeoFlickr example shows how to use the user's current position to fetch local content from a web service.</db:para>
</db:abstract>
<db:pubdate>2025-06-29</db:pubdate>
<db:date>2025-06-29</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:para>This is a small example, illustrating one of the very core parts of the <db:link xlink:href="qtpositioning-index.xml">Qt Positioning</db:link> API: the ability to retrieve and use the user's current geographic position.</db:para>
<db:para>Key QML types shown in this example:</db:para>
<db:itemizedlist>
<db:listitem>
<db:para><db:link xlink:href="qml-qtpositioning-positionsource.xml">PositionSource</db:link></db:para>
</db:listitem>
<db:listitem>
<db:para><db:link xlink:href="qml-qtquick-xmllistmodel-xmllistmodel.xml">XmlListModel</db:link></db:para>
</db:listitem>
</db:itemizedlist>
<db:mediaobject>
<db:imageobject>
<db:imagedata fileref="images/qml-flickr-1.jpg"/>
</db:imageobject>
</db:mediaobject>
<db:section xml:id="running-the-example">
<db:title>Running the Example</db:title>
<db:para>To run the example from <db:link xlink:href="http://doc.qt.io/qtcreator/index.html">Qt Creator</db:link>, open the <db:emphasis role="bold">Welcome</db:emphasis> mode and select the example from <db:emphasis role="bold">Examples</db:emphasis>. For more information, visit <db:link xlink:href="http://doc.qt.io/qtcreator/creator-build-example-application.html">Building and Running an Example</db:link>.</db:para>
</db:section>
<db:section xml:id="retrieving-the-current-position">
<db:title>Retrieving the Current Position</db:title>
<db:para>Retrieving the user's current position is achieved using the <db:link xlink:href="qml-qtpositioning-positionsource.xml">PositionSource</db:link> type. In this example, we instantiate the <db:link xlink:href="qml-qtpositioning-positionsource.xml">PositionSource</db:link> as part of the GeoTab component (the floating &quot;window&quot; describing current position and status).</db:para>
<db:programlisting language="qml">    PositionSource {
        id: positionSource
        onPositionChanged: { planet.source = &quot;images/sun.png&quot;; }

        onSourceErrorChanged: {
            if (sourceError == PositionSource.NoError)
                return

            console.log(&quot;Source error: &quot; + sourceError)
            activityText.fadeOut = true
            stop()
        }

        onUpdateTimeout: {
            activityText.fadeOut = true
        }
    }
</db:programlisting>
<db:para>When the &quot;Locate and update&quot; button is pressed, we first interrogate the <db:link xlink:href="qml-qtpositioning-positionsource.xml">PositionSource</db:link> to check if it has an available backend for positioning data. If it does not, we fall back to using a pre-recorded NMEA log for demonstration. We then instruct the <db:link xlink:href="qml-qtpositioning-positionsource.xml">PositionSource</db:link> to update.</db:para>
<db:programlisting language="qml">    Button {
        id: locateButton
        text: &quot;Locate &amp; update&quot;
        onClicked: {
            if (positionSource.supportedPositioningMethods ===
                    PositionSource.NoPositioningMethods) {
                positionSource.nmeaSource = &quot;nmealog.txt&quot;;
                sourceText.text = &quot;(filesource): &quot; + printableMethod(positionSource.supportedPositioningMethods);
            }
            positionSource.update();
        }
    }
</db:programlisting>
<db:para>To share the new position data with the rest of the application, we use properties that we have created on the GeoTab component:</db:para>
<db:programlisting language="qml">    property variant coordinate
</db:programlisting>
</db:section>
<db:section xml:id="using-the-current-position">
<db:title>Using the Current Position</db:title>
<db:para>The longitude and latitude values retrieved here are eventually set on in properties on the RestModel component. The RestModel is an <db:link xlink:href="qml-qtquick-xmllistmodel-xmllistmodel.xml">XmlListModel</db:link>, which retrieves XML data from a URL and creates a data model by performing XPath queries on it.</db:para>
<db:para>In this case, it retrieves data from the Flickr REST API online, based on our current position</db:para>
<db:programlisting language="qml">XmlListModel {
    property variant coordinate

    source: &quot;https://api.flickr.com/services/rest/?&quot; +
            &quot;min_taken_date=2000-01-01+0:00:00&amp;&quot; +
            &quot;extras=date_taken&amp;&quot; +
            &quot;method=flickr.photos.search&amp;&quot; +
            &quot;per_page=30&amp;&quot; +
            &quot;sort=date-taken-desc&amp;&quot; +
            &quot;api_key=e36784df8a03fea04c22ed93318b291c&amp;&quot; +
            &quot;lat=&quot; + coordinate.latitude + &quot;&amp;lon=&quot; + coordinate.longitude;
    query: &quot;/rsp/photos/photo&quot;

    XmlRole { name: &quot;title&quot;; query: &quot;@title/string()&quot; }
    XmlRole { name: &quot;datetaken&quot;; query: &quot;@datetaken/string()&quot; }
    XmlRole { name: &quot;farm&quot;; query: &quot;@farm/string()&quot; }
    XmlRole { name: &quot;server&quot;; query: &quot;@server/string()&quot; }
    XmlRole { name: &quot;id&quot;; query: &quot;@id/string()&quot; }
    XmlRole { name: &quot;secret&quot;; query: &quot;@secret/string()&quot; }
}
</db:programlisting>
<db:para>This model data is then shown in a variety of Qt Quick views to produce the example application.</db:para>
</db:section>
<db:section>
<db:title>List of Files</db:title>
<db:para>Files:</db:para>
<db:section>
<db:title>List of Files</db:title>
<db:itemizedlist>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickr-90.qml">geoflickr/flickr-90.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickr.qml">geoflickr/flickr.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickr.qrc">geoflickr/flickr.qrc</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrcommon/Progress.qml">geoflickr/flickrcommon/Progress.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrcommon/RestModel.qml">geoflickr/flickrcommon/RestModel.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrcommon/ScrollBar.qml">geoflickr/flickrcommon/ScrollBar.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrcommon/Slider.qml">geoflickr/flickrcommon/Slider.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/Button.qml">geoflickr/flickrmobile/Button.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/GeoTab.qml">geoflickr/flickrmobile/GeoTab.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/GridDelegate.qml">geoflickr/flickrmobile/GridDelegate.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/ImageDetails.qml">geoflickr/flickrmobile/ImageDetails.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/ListDelegate.qml">geoflickr/flickrmobile/ListDelegate.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/TitleBar.qml">geoflickr/flickrmobile/TitleBar.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/ToolBar.qml">geoflickr/flickrmobile/ToolBar.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/geoflickr.pro">geoflickr/geoflickr.pro</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/geoflickr.qmlproject">geoflickr/geoflickr.qmlproject</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/qmllocationflickr.cpp">geoflickr/qmllocationflickr.cpp</db:link></db:para></db:listitem>
</db:itemizedlist>
</db:section>
<db:section>
<db:title>List of Files</db:title>
<db:para>Images:</db:para>
<db:section>
<db:title>List of Files</db:title>
<db:itemizedlist>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/gloss.png">geoflickr/flickrmobile/images/gloss.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/lineedit.png">geoflickr/flickrmobile/images/lineedit.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/moon.png">geoflickr/flickrmobile/images/moon.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/quit.png">geoflickr/flickrmobile/images/quit.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/star.png">geoflickr/flickrmobile/images/star.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/stripes.png">geoflickr/flickrmobile/images/stripes.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/sun.png">geoflickr/flickrmobile/images/sun.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/titlebar.png">geoflickr/flickrmobile/images/titlebar.png</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="geoflickr/flickrmobile/images/toolbutton.png">geoflickr/flickrmobile/images/toolbutton.png</db:link></db:para></db:listitem>
</db:itemizedlist>
</db:section>
</db:section></db:section></db:article>
