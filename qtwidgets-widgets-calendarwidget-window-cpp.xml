<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en">
<db:info>
<db:title>Calendar Widget Example</db:title>
<db:productname>QtWidgets</db:productname>
<db:edition>Qt 5.6.3 Reference Documentation</db:edition>
<db:titleabbrev>Qt Widgets Reference Documentation</db:titleabbrev>
<db:abstract>
<db:para>The Calendar Widget example shows use of <db:link xlink:href="qcalendarwidget.xml">QCalendarWidget</db:link>.</db:para>
</db:abstract>
<db:pubdate>2025-06-29</db:pubdate>
<db:date>2025-06-29</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:programlisting language="cpp">/****************************************************************************
**
** Copyright (C) 2015 The Qt Company Ltd.
** Contact: http://www.qt.io/licensing/
**
** This file is part of the examples of the Qt Toolkit.
**
** $QT_BEGIN_LICENSE:BSD$
** You may use this file under the terms of the BSD license as follows:
**
** &quot;Redistribution and use in source and binary forms, with or without
** modification, are permitted provided that the following conditions are
** met:
**   * Redistributions of source code must retain the above copyright
**     notice, this list of conditions and the following disclaimer.
**   * Redistributions in binary form must reproduce the above copyright
**     notice, this list of conditions and the following disclaimer in
**     the documentation and/or other materials provided with the
**     distribution.
**   * Neither the name of The Qt Company Ltd nor the names of its
**     contributors may be used to endorse or promote products derived
**     from this software without specific prior written permission.
**
**
** THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
** &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
** LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
** A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
** OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
** SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
** LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
** DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
** THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
** (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
** OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.&quot;
**
** $QT_END_LICENSE$
**
****************************************************************************/

#include &lt;QtWidgets&gt;

#include &quot;window.h&quot;

Window::Window()
{
    createPreviewGroupBox();
    createGeneralOptionsGroupBox();
    createDatesGroupBox();
    createTextFormatsGroupBox();

    QGridLayout *layout = new QGridLayout;
    layout-&gt;addWidget(previewGroupBox, 0, 0);
    layout-&gt;addWidget(generalOptionsGroupBox, 0, 1);
    layout-&gt;addWidget(datesGroupBox, 1, 0);
    layout-&gt;addWidget(textFormatsGroupBox, 1, 1);
    layout-&gt;setSizeConstraint(QLayout::SetFixedSize);
    setLayout(layout);

    previewLayout-&gt;setRowMinimumHeight(0, calendar-&gt;sizeHint().height());
    previewLayout-&gt;setColumnMinimumWidth(0, calendar-&gt;sizeHint().width());

    setWindowTitle(tr(&quot;Calendar Widget&quot;));
}

void Window::localeChanged(int index)
{
    const QLocale newLocale(localeCombo-&gt;itemData(index).toLocale());
    calendar-&gt;setLocale(newLocale);
    int newLocaleFirstDayIndex = firstDayCombo-&gt;findData(newLocale.firstDayOfWeek());
    firstDayCombo-&gt;setCurrentIndex(newLocaleFirstDayIndex);
}

void Window::firstDayChanged(int index)
{
    calendar-&gt;setFirstDayOfWeek(Qt::DayOfWeek(
                                firstDayCombo-&gt;itemData(index).toInt()));
}

void Window::selectionModeChanged(int index)
{
    calendar-&gt;setSelectionMode(QCalendarWidget::SelectionMode(
                               selectionModeCombo-&gt;itemData(index).toInt()));
}

void Window::horizontalHeaderChanged(int index)
{
    calendar-&gt;setHorizontalHeaderFormat(QCalendarWidget::HorizontalHeaderFormat(
        horizontalHeaderCombo-&gt;itemData(index).toInt()));
}

void Window::verticalHeaderChanged(int index)
{
    calendar-&gt;setVerticalHeaderFormat(QCalendarWidget::VerticalHeaderFormat(
        verticalHeaderCombo-&gt;itemData(index).toInt()));
}

void Window::selectedDateChanged()
{
    currentDateEdit-&gt;setDate(calendar-&gt;selectedDate());
}

void Window::minimumDateChanged(const QDate &amp;date)
{
    calendar-&gt;setMinimumDate(date);
    maximumDateEdit-&gt;setDate(calendar-&gt;maximumDate());
}

void Window::maximumDateChanged(const QDate &amp;date)
{
    calendar-&gt;setMaximumDate(date);
    minimumDateEdit-&gt;setDate(calendar-&gt;minimumDate());
}

void Window::weekdayFormatChanged()
{
    QTextCharFormat format;

    format.setForeground(qvariant_cast&lt;QColor&gt;(
        weekdayColorCombo-&gt;itemData(weekdayColorCombo-&gt;currentIndex())));
    calendar-&gt;setWeekdayTextFormat(Qt::Monday, format);
    calendar-&gt;setWeekdayTextFormat(Qt::Tuesday, format);
    calendar-&gt;setWeekdayTextFormat(Qt::Wednesday, format);
    calendar-&gt;setWeekdayTextFormat(Qt::Thursday, format);
    calendar-&gt;setWeekdayTextFormat(Qt::Friday, format);
}

void Window::weekendFormatChanged()
{
    QTextCharFormat format;

    format.setForeground(qvariant_cast&lt;QColor&gt;(
        weekendColorCombo-&gt;itemData(weekendColorCombo-&gt;currentIndex())));
    calendar-&gt;setWeekdayTextFormat(Qt::Saturday, format);
    calendar-&gt;setWeekdayTextFormat(Qt::Sunday, format);
}

void Window::reformatHeaders()
{
    QString text = headerTextFormatCombo-&gt;currentText();
    QTextCharFormat format;

    if (text == tr(&quot;Bold&quot;)) {
        format.setFontWeight(QFont::Bold);
    } else if (text == tr(&quot;Italic&quot;)) {
        format.setFontItalic(true);
    } else if (text == tr(&quot;Green&quot;)) {
        format.setForeground(Qt::green);
    }
    calendar-&gt;setHeaderTextFormat(format);
}

void Window::reformatCalendarPage()
{
    QTextCharFormat mayFirstFormat;
    const QDate mayFirst(calendar-&gt;yearShown(), 5, 1);

    QTextCharFormat firstFridayFormat;
    QDate firstFriday(calendar-&gt;yearShown(), calendar-&gt;monthShown(), 1);
    while (firstFriday.dayOfWeek() != Qt::Friday)
        firstFriday = firstFriday.addDays(1);

    if (firstFridayCheckBox-&gt;isChecked()) {
        firstFridayFormat.setForeground(Qt::blue);
    } else { // Revert to regular colour for this day of the week.
        Qt::DayOfWeek dayOfWeek(static_cast&lt;Qt::DayOfWeek&gt;(firstFriday.dayOfWeek()));
        firstFridayFormat.setForeground(calendar-&gt;weekdayTextFormat(dayOfWeek).foreground());
    }

    calendar-&gt;setDateTextFormat(firstFriday, firstFridayFormat);

    // When it is checked, &quot;May First in Red&quot; always takes precedence over &quot;First Friday in Blue&quot;.
    if (mayFirstCheckBox-&gt;isChecked()) {
        mayFirstFormat.setForeground(Qt::red);
    } else if (!firstFridayCheckBox-&gt;isChecked() || firstFriday != mayFirst) {
        // We can now be certain we won't be resetting &quot;May First in Red&quot; when we restore
        // may 1st's regular colour for this day of the week.
        Qt::DayOfWeek dayOfWeek(static_cast&lt;Qt::DayOfWeek&gt;(mayFirst.dayOfWeek()));
        calendar-&gt;setDateTextFormat(mayFirst, calendar-&gt;weekdayTextFormat(dayOfWeek));
    }

    calendar-&gt;setDateTextFormat(mayFirst, mayFirstFormat);
}

void Window::createPreviewGroupBox()
{
    previewGroupBox = new QGroupBox(tr(&quot;Preview&quot;));

    calendar = new QCalendarWidget;
    calendar-&gt;setMinimumDate(QDate(1900, 1, 1));
    calendar-&gt;setMaximumDate(QDate(3000, 1, 1));
    calendar-&gt;setGridVisible(true);

    connect(calendar, SIGNAL(currentPageChanged(int,int)),
            this, SLOT(reformatCalendarPage()));

    previewLayout = new QGridLayout;
    previewLayout-&gt;addWidget(calendar, 0, 0, Qt::AlignCenter);
    previewGroupBox-&gt;setLayout(previewLayout);
}

void Window::createGeneralOptionsGroupBox()
{
    generalOptionsGroupBox = new QGroupBox(tr(&quot;General Options&quot;));

    localeCombo = new QComboBox;
    int curLocaleIndex = -1;
    int index = 0;
    for (int _lang = QLocale::C; _lang &lt;= QLocale::LastLanguage; ++_lang) {
        QLocale::Language lang = static_cast&lt;QLocale::Language&gt;(_lang);
        QList&lt;QLocale::Country&gt; countries = QLocale::countriesForLanguage(lang);
        for (int i = 0; i &lt; countries.count(); ++i) {
            QLocale::Country country = countries.at(i);
            QString label = QLocale::languageToString(lang);
            label += QLatin1Char('/');
            label += QLocale::countryToString(country);
            QLocale locale(lang, country);
            if (this-&gt;locale().language() == lang &amp;&amp; this-&gt;locale().country() == country)
                curLocaleIndex = index;
            localeCombo-&gt;addItem(label, locale);
            ++index;
        }
    }
    if (curLocaleIndex != -1)
        localeCombo-&gt;setCurrentIndex(curLocaleIndex);
    localeLabel = new QLabel(tr(&quot;&amp;Locale&quot;));
    localeLabel-&gt;setBuddy(localeCombo);

    firstDayCombo = new QComboBox;
    firstDayCombo-&gt;addItem(tr(&quot;Sunday&quot;), Qt::Sunday);
    firstDayCombo-&gt;addItem(tr(&quot;Monday&quot;), Qt::Monday);
    firstDayCombo-&gt;addItem(tr(&quot;Tuesday&quot;), Qt::Tuesday);
    firstDayCombo-&gt;addItem(tr(&quot;Wednesday&quot;), Qt::Wednesday);
    firstDayCombo-&gt;addItem(tr(&quot;Thursday&quot;), Qt::Thursday);
    firstDayCombo-&gt;addItem(tr(&quot;Friday&quot;), Qt::Friday);
    firstDayCombo-&gt;addItem(tr(&quot;Saturday&quot;), Qt::Saturday);

    firstDayLabel = new QLabel(tr(&quot;Wee&amp;k starts on:&quot;));
    firstDayLabel-&gt;setBuddy(firstDayCombo);

    selectionModeCombo = new QComboBox;
    selectionModeCombo-&gt;addItem(tr(&quot;Single selection&quot;),
                                QCalendarWidget::SingleSelection);
    selectionModeCombo-&gt;addItem(tr(&quot;None&quot;), QCalendarWidget::NoSelection);

    selectionModeLabel = new QLabel(tr(&quot;&amp;Selection mode:&quot;));
    selectionModeLabel-&gt;setBuddy(selectionModeCombo);

    gridCheckBox = new QCheckBox(tr(&quot;&amp;Grid&quot;));
    gridCheckBox-&gt;setChecked(calendar-&gt;isGridVisible());

    navigationCheckBox = new QCheckBox(tr(&quot;&amp;Navigation bar&quot;));
    navigationCheckBox-&gt;setChecked(true);

    horizontalHeaderCombo = new QComboBox;
    horizontalHeaderCombo-&gt;addItem(tr(&quot;Single letter day names&quot;),
                                   QCalendarWidget::SingleLetterDayNames);
    horizontalHeaderCombo-&gt;addItem(tr(&quot;Short day names&quot;),
                                   QCalendarWidget::ShortDayNames);
    horizontalHeaderCombo-&gt;addItem(tr(&quot;None&quot;),
                                   QCalendarWidget::NoHorizontalHeader);
    horizontalHeaderCombo-&gt;setCurrentIndex(1);

    horizontalHeaderLabel = new QLabel(tr(&quot;&amp;Horizontal header:&quot;));
    horizontalHeaderLabel-&gt;setBuddy(horizontalHeaderCombo);

    verticalHeaderCombo = new QComboBox;
    verticalHeaderCombo-&gt;addItem(tr(&quot;ISO week numbers&quot;),
                                 QCalendarWidget::ISOWeekNumbers);
    verticalHeaderCombo-&gt;addItem(tr(&quot;None&quot;), QCalendarWidget::NoVerticalHeader);

    verticalHeaderLabel = new QLabel(tr(&quot;&amp;Vertical header:&quot;));
    verticalHeaderLabel-&gt;setBuddy(verticalHeaderCombo);

    connect(localeCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(localeChanged(int)));
    connect(firstDayCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(firstDayChanged(int)));
    connect(selectionModeCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(selectionModeChanged(int)));
    connect(gridCheckBox, SIGNAL(toggled(bool)),
            calendar, SLOT(setGridVisible(bool)));
    connect(navigationCheckBox, SIGNAL(toggled(bool)),
            calendar, SLOT(setNavigationBarVisible(bool)));
    connect(horizontalHeaderCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(horizontalHeaderChanged(int)));
    connect(verticalHeaderCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(verticalHeaderChanged(int)));

    QHBoxLayout *checkBoxLayout = new QHBoxLayout;
    checkBoxLayout-&gt;addWidget(gridCheckBox);
    checkBoxLayout-&gt;addStretch();
    checkBoxLayout-&gt;addWidget(navigationCheckBox);

    QGridLayout *outerLayout = new QGridLayout;
    outerLayout-&gt;addWidget(localeLabel, 0, 0);
    outerLayout-&gt;addWidget(localeCombo, 0, 1);
    outerLayout-&gt;addWidget(firstDayLabel, 1, 0);
    outerLayout-&gt;addWidget(firstDayCombo, 1, 1);
    outerLayout-&gt;addWidget(selectionModeLabel, 2, 0);
    outerLayout-&gt;addWidget(selectionModeCombo, 2, 1);
    outerLayout-&gt;addLayout(checkBoxLayout, 3, 0, 1, 2);
    outerLayout-&gt;addWidget(horizontalHeaderLabel, 4, 0);
    outerLayout-&gt;addWidget(horizontalHeaderCombo, 4, 1);
    outerLayout-&gt;addWidget(verticalHeaderLabel, 5, 0);
    outerLayout-&gt;addWidget(verticalHeaderCombo, 5, 1);
    generalOptionsGroupBox-&gt;setLayout(outerLayout);

    firstDayChanged(firstDayCombo-&gt;currentIndex());
    selectionModeChanged(selectionModeCombo-&gt;currentIndex());
    horizontalHeaderChanged(horizontalHeaderCombo-&gt;currentIndex());
    verticalHeaderChanged(verticalHeaderCombo-&gt;currentIndex());
}

void Window::createDatesGroupBox()
{
    datesGroupBox = new QGroupBox(tr(&quot;Dates&quot;));

    minimumDateEdit = new QDateEdit;
    minimumDateEdit-&gt;setDisplayFormat(&quot;MMM d yyyy&quot;);
    minimumDateEdit-&gt;setDateRange(calendar-&gt;minimumDate(),
                                  calendar-&gt;maximumDate());
    minimumDateEdit-&gt;setDate(calendar-&gt;minimumDate());

    minimumDateLabel = new QLabel(tr(&quot;&amp;Minimum Date:&quot;));
    minimumDateLabel-&gt;setBuddy(minimumDateEdit);

    currentDateEdit = new QDateEdit;
    currentDateEdit-&gt;setDisplayFormat(&quot;MMM d yyyy&quot;);
    currentDateEdit-&gt;setDate(calendar-&gt;selectedDate());
    currentDateEdit-&gt;setDateRange(calendar-&gt;minimumDate(),
                                  calendar-&gt;maximumDate());

    currentDateLabel = new QLabel(tr(&quot;&amp;Current Date:&quot;));
    currentDateLabel-&gt;setBuddy(currentDateEdit);

    maximumDateEdit = new QDateEdit;
    maximumDateEdit-&gt;setDisplayFormat(&quot;MMM d yyyy&quot;);
    maximumDateEdit-&gt;setDateRange(calendar-&gt;minimumDate(),
                                  calendar-&gt;maximumDate());
    maximumDateEdit-&gt;setDate(calendar-&gt;maximumDate());

    maximumDateLabel = new QLabel(tr(&quot;Ma&amp;ximum Date:&quot;));
    maximumDateLabel-&gt;setBuddy(maximumDateEdit);

    connect(currentDateEdit, SIGNAL(dateChanged(QDate)),
            calendar, SLOT(setSelectedDate(QDate)));
    connect(calendar, SIGNAL(selectionChanged()),
            this, SLOT(selectedDateChanged()));
    connect(minimumDateEdit, SIGNAL(dateChanged(QDate)),
            this, SLOT(minimumDateChanged(QDate)));
    connect(maximumDateEdit, SIGNAL(dateChanged(QDate)),
            this, SLOT(maximumDateChanged(QDate)));

    QGridLayout *dateBoxLayout = new QGridLayout;
    dateBoxLayout-&gt;addWidget(currentDateLabel, 1, 0);
    dateBoxLayout-&gt;addWidget(currentDateEdit, 1, 1);
    dateBoxLayout-&gt;addWidget(minimumDateLabel, 0, 0);
    dateBoxLayout-&gt;addWidget(minimumDateEdit, 0, 1);
    dateBoxLayout-&gt;addWidget(maximumDateLabel, 2, 0);
    dateBoxLayout-&gt;addWidget(maximumDateEdit, 2, 1);
    dateBoxLayout-&gt;setRowStretch(3, 1);

    datesGroupBox-&gt;setLayout(dateBoxLayout);
}

void Window::createTextFormatsGroupBox()
{
    textFormatsGroupBox = new QGroupBox(tr(&quot;Text Formats&quot;));

    weekdayColorCombo = createColorComboBox();
    weekdayColorCombo-&gt;setCurrentIndex(
            weekdayColorCombo-&gt;findText(tr(&quot;Black&quot;)));

    weekdayColorLabel = new QLabel(tr(&quot;&amp;Weekday color:&quot;));
    weekdayColorLabel-&gt;setBuddy(weekdayColorCombo);

    weekendColorCombo = createColorComboBox();
    weekendColorCombo-&gt;setCurrentIndex(
            weekendColorCombo-&gt;findText(tr(&quot;Red&quot;)));

    weekendColorLabel = new QLabel(tr(&quot;Week&amp;end color:&quot;));
    weekendColorLabel-&gt;setBuddy(weekendColorCombo);

    headerTextFormatCombo = new QComboBox;
    headerTextFormatCombo-&gt;addItem(tr(&quot;Bold&quot;));
    headerTextFormatCombo-&gt;addItem(tr(&quot;Italic&quot;));
    headerTextFormatCombo-&gt;addItem(tr(&quot;Plain&quot;));

    headerTextFormatLabel = new QLabel(tr(&quot;&amp;Header text:&quot;));
    headerTextFormatLabel-&gt;setBuddy(headerTextFormatCombo);

    firstFridayCheckBox = new QCheckBox(tr(&quot;&amp;First Friday in blue&quot;));

    mayFirstCheckBox = new QCheckBox(tr(&quot;May &amp;1 in red&quot;));

    connect(weekdayColorCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(weekdayFormatChanged()));
    connect(weekdayColorCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(reformatCalendarPage()));
    connect(weekendColorCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(weekendFormatChanged()));
    connect(weekendColorCombo, SIGNAL(currentIndexChanged(int)),
            this, SLOT(reformatCalendarPage()));
    connect(headerTextFormatCombo, SIGNAL(currentIndexChanged(QString)),
            this, SLOT(reformatHeaders()));
    connect(firstFridayCheckBox, SIGNAL(toggled(bool)),
            this, SLOT(reformatCalendarPage()));
    connect(mayFirstCheckBox, SIGNAL(toggled(bool)),
            this, SLOT(reformatCalendarPage()));

    QHBoxLayout *checkBoxLayout = new QHBoxLayout;
    checkBoxLayout-&gt;addWidget(firstFridayCheckBox);
    checkBoxLayout-&gt;addStretch();
    checkBoxLayout-&gt;addWidget(mayFirstCheckBox);

    QGridLayout *outerLayout = new QGridLayout;
    outerLayout-&gt;addWidget(weekdayColorLabel, 0, 0);
    outerLayout-&gt;addWidget(weekdayColorCombo, 0, 1);
    outerLayout-&gt;addWidget(weekendColorLabel, 1, 0);
    outerLayout-&gt;addWidget(weekendColorCombo, 1, 1);
    outerLayout-&gt;addWidget(headerTextFormatLabel, 2, 0);
    outerLayout-&gt;addWidget(headerTextFormatCombo, 2, 1);
    outerLayout-&gt;addLayout(checkBoxLayout, 3, 0, 1, 2);
    textFormatsGroupBox-&gt;setLayout(outerLayout);

    weekdayFormatChanged();
    weekendFormatChanged();
    reformatHeaders();
    reformatCalendarPage();
}

QComboBox *Window::createColorComboBox()
{
    QComboBox *comboBox = new QComboBox;
    comboBox-&gt;addItem(tr(&quot;Red&quot;), QColor(Qt::red));
    comboBox-&gt;addItem(tr(&quot;Blue&quot;), QColor(Qt::blue));
    comboBox-&gt;addItem(tr(&quot;Black&quot;), QColor(Qt::black));
    comboBox-&gt;addItem(tr(&quot;Magenta&quot;), QColor(Qt::magenta));
    return comboBox;
}

</db:programlisting>
</db:article>
