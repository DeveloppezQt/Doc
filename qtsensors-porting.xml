<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en">
<db:info>
<db:title>Porting Applications from QtMobility Sensors to Qt Sensors</db:title>
<db:productname>QtSensors</db:productname>
<db:edition>Qt 5.12.12 Reference Documentation</db:edition>
<db:titleabbrev>Qt Sensors Reference Documentation</db:titleabbrev>
<db:abstract>
<db:para>Explain how to port from QtMobility Sensors to Qt Sensors.</db:para>
<db:para>This documentation was introduced in Qt 5.1.</db:para>
</db:abstract>
<db:pubdate>2024-12-27</db:pubdate>
<db:date>2024-12-27</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:section xml:id="overview">
<db:title>Overview</db:title>
<db:para>The initial release of Qt Sensors (5.0) is generally expected to be source compatible with QtMobility Sensors 1.2. This document attempts to explain where things need to be changed in order to port applications to Qt Sensors.</db:para>
</db:section>
<db:section xml:id="qml">
<db:title>QML</db:title>
<db:para>In <db:code>QtMobility</db:code>, the C++ classes like <db:code>QAccelerometer</db:code> were directly used as QML types. In Qt Sensors, there are now separate classes for the QML types, which have no public C++ API.</db:para>
<db:para>The new QML types in Qt Sensors fix some issues the former QtMobility QML types had, for example:</db:para>
<db:itemizedlist>
<db:listitem>
<db:para>The reading types now have proper change notifications.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>availableDataRates</db:code> and <db:code>outputRanges</db:code> of the <db:code>Sensor</db:code> type are now proper list types.</db:para>
</db:listitem>
<db:listitem>
<db:para>The <db:code>identifier</db:code> and <db:code>type</db:code> properties of <db:code>Sensor</db:code> can now be used.</db:para>
</db:listitem>
<db:listitem>
<db:para>The <db:code>lux</db:code> property of <db:code>LightSensorReading</db:code> has been renamed to <db:code>illuminance</db:code>.</db:para>
</db:listitem>
<db:listitem>
<db:para>The <db:code>QmlSensors</db:code> singleton now allows to query for sensor types.</db:para>
</db:listitem>
</db:itemizedlist>
<db:para>For more information, see the <db:link xlink:href="qtsensors-qmlmodule.xml">QML API</db:link> documentation.</db:para>
</db:section>
<db:section xml:id="c">
<db:title>C++</db:title>
<db:para>The C++ API mainly remained the same as in QtMobility.</db:para>
<db:section xml:id="includes">
<db:title>Includes</db:title>
<db:para>QtMobility Sensors installed headers into a <db:code>Qt</db:code> Sensors directory. This is also the directory that Qt Sensors uses. It is therefore expected that includes that worked with QtMobility Sensors should continue to work.</db:para>
<db:para>For example:</db:para>
<db:programlisting language="cpp">#include &amp;lt;QAccelerometer&amp;gt;
#include &amp;lt;qaccelerometer.h&amp;gt;
#include &amp;lt;QtSensors/QAccelerometer&amp;gt;
#include &amp;lt;QtSensors/qaccelerometer.h&amp;gt;
</db:programlisting>
</db:section>
<db:section xml:id="macros-and-namespace">
<db:title>Macros and Namespace</db:title>
<db:para>QtMobility Sensors was built in a <db:code>QtMobility</db:code> namespace. This was enabled by the use of various macros. Qt Sensors does not normally build into a namespace and the macros from QtMobility no longer exist.</db:para>
<db:itemizedlist>
<db:listitem>
<db:para>QTM_BEGIN_NAMESPACE</db:para>
</db:listitem>
<db:listitem>
<db:para>QTM_END_NAMESPACE</db:para>
</db:listitem>
<db:listitem>
<db:para>QTM_USE_NAMESPACE</db:para>
</db:listitem>
<db:listitem>
<db:para>QTM_PREPEND_NAMESPACE(x)</db:para>
</db:listitem>
</db:itemizedlist>
<db:para>Note that Qt can be configured to build into a namespace. If Qt is built in this way then Qt Sensors is also built into the nominated namespace. However, as this is optional, the macros for this are typically defined to do nothing.</db:para>
<db:itemizedlist>
<db:listitem>
<db:para>QT_BEGIN_NAMESPACE</db:para>
</db:listitem>
<db:listitem>
<db:para>QT_END_NAMESPACE</db:para>
</db:listitem>
<db:listitem>
<db:para>QT_USE_NAMESPACE</db:para>
</db:listitem>
<db:listitem>
<db:para>QT_PREPEND_NAMESPACE(x)</db:para>
</db:listitem>
</db:itemizedlist>
</db:section>
<db:section xml:id="qtimestamp">
<db:title>qtimestamp</db:title>
<db:para>qtimestamp was previously defined as an opaque type equivalent to a quint64. It existed as a class due to an implementation detail.</db:para>
<db:para>In Qt Sensors, the API uses quint64 instead of qtimestamp. qtimestamp still exists as a typedef so that applications that refer to qtimestamp can be compiled.</db:para>
</db:section>
</db:section>
<db:section xml:id="project-files">
<db:title>Project Files</db:title>
<db:para>QtMobility Sensors applications used this in their project files to enable the Sensors API.</db:para>
<db:programlisting language="cpp">CONFIG += mobility
MOBILITY += sensors
</db:programlisting>
<db:para>Applications should remove these lines and instead use the following statement to enable the Qt Sensors API:</db:para>
<db:programlisting language="cpp">QT += sensors
</db:programlisting>
</db:section>
</db:article>
