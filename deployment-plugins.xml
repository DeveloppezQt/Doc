<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en">
<db:info>
<db:title>Deploying Plugins</db:title>
<db:productname>QtDoc</db:productname>
<db:edition>Qt 5.11.3 Reference Documentation</db:edition>
<db:titleabbrev>Qt Reference Documentation</db:titleabbrev>
<db:abstract>
<db:para>A guide to plugins-specific aspects of deploying Qt and Qt Application.</db:para>
</db:abstract>
<db:pubdate>2024-12-27</db:pubdate>
<db:date>2024-12-27</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:para>This document explains how to deploy plugin libraries that Qt or your application should load at runtime. If you use <db:link xlink:href="plugins-howto.xml#static-plugins">static plugins</db:link>, then the plugin code is already part of your application executable, and no separate deployment steps are required.</db:para>
<db:section xml:id="the-plugin-directory">
<db:title>The Plugin Directory</db:title>
<db:para>When the application is run, Qt will first treat the application's executable directory as the base directory for searching for plugins. For example if the application is in <db:code>C:\Program Files\MyApp</db:code> and has a style plugin, Qt will look in <db:code>C:\Program Files\MyApp\styles</db:code>. (See <db:link xlink:href="qcoreapplication.xml#applicationDirPath">QCoreApplication::applicationDirPath</db:link>() for how to find out where the application's executable is.) Qt will also look in the directory specified by <db:link xlink:href="qlibraryinfo.xml#location">QLibraryInfo::location</db:link>(<db:link xlink:href="qlibraryinfo.xml#LibraryLocation-enum">QLibraryInfo::PluginsPath</db:link>), which typically is located in <db:code>QTDIR/plugins</db:code> (where <db:code>QTDIR</db:code> is the directory where Qt is installed). If you want Qt to look in additional places you can add as many paths as you need with calls to <db:link xlink:href="qcoreapplication.xml#addLibraryPath">QCoreApplication::addLibraryPath</db:link>(). And if you want to set your own path or paths you can use <db:link xlink:href="qcoreapplication.xml#setLibraryPaths">QCoreApplication::setLibraryPaths</db:link>(). You can also use a <db:code>qt.conf</db:code> file to override the hard-coded paths that are compiled into the Qt library. For more information, see the <db:link xlink:href="qt-conf.xml">Using qt.conf</db:link> documentation. Yet another possibility is to set the <db:code>QT_PLUGIN_PATH</db:code> environment variable before running the application. If set, Qt will look for plugins in the paths (separated by the system path separator) specified in the variable.</db:para>
<db:note>
<db:para><db:code>QT_PLUGIN_PATH</db:code> should not be exported as a system-wide environment variable since it can interfere with other Qt installations.</db:para>
</db:note>
</db:section>
<db:section xml:id="loading-and-verifying-plugins-dynamically">
<db:title>Loading and Verifying Plugins Dynamically</db:title>
<db:para>When loading plugins, the Qt library does some sanity checking to determine whether or not the plugin can be loaded and used. This provides the ability to have multiple versions and configurations of the Qt library installed side by side.</db:para>
<db:itemizedlist>
<db:listitem>
<db:para>Plugins linked with a Qt library that has a higher version number will not be loaded by a library with a lower version number.</db:para>
<db:para><db:emphasis role="bold">Example:</db:emphasis> Qt 5.0.0 will <db:emphasis>not</db:emphasis> load a plugin built with Qt 5.0.1.</db:para>
</db:listitem>
<db:listitem>
<db:para>Plugins linked with a Qt library that has a lower major version number will not be loaded by a library with a higher major version number.</db:para>
<db:para><db:emphasis role="bold">Example:</db:emphasis> Qt 5.0.1 will <db:emphasis>not</db:emphasis> load a plugin built with Qt 4.8.2.  <db:emphasis role="bold">Example:</db:emphasis> Qt 5.1.1 will load plugins built with Qt 5.1.0 and Qt 5.0.3.</db:para>
</db:listitem>
</db:itemizedlist>
<db:para>When building plugins to extend an application, it is important to ensure that the plugin is configured in the same way as the application. This means that if the application was built in release mode, plugins should be built in release mode, too. Except for Unix operating systems, plugins build in a different mode will not get loaded by the plugin system.</db:para>
<db:para>If you configure Qt to be built in both debug and release modes, but only build applications in release mode, you need to ensure that your plugins are also built in release mode. By default, if a debug build of Qt is available, plugins will <db:emphasis>only</db:emphasis> be built in debug mode. To force the plugins to be built in release mode, add the following line to the plugin's project file:</db:para>
<db:programlisting language="cpp">CONFIG += release
</db:programlisting>
<db:para>This will ensure that the plugin is compatible with the version of the library used in the application.</db:para>
</db:section>
<db:section xml:id="debugging-plugins">
<db:title>Debugging Plugins</db:title>
<db:para>There are a number of issues that may prevent correctly-written plugins from working with the applications that are designed to use them. Many of these are related to differences in the way that plugins and applications have been built, often arising from separate build systems and processes.</db:para>
<db:para>The following table contains descriptions of the common causes of problems developers experience when creating plugins:</db:para>
<db:informaltable style="generic">
<db:thead>
<db:tr>
<db:th>
<db:para>Problem</db:para>
</db:th>
<db:th>
<db:para>Cause</db:para>
</db:th>
<db:th>
<db:para>Solution</db:para>
</db:th>
</db:tr>
</db:thead>
<db:tr valign="top">
<db:td>
<db:para>Plugins sliently fail to load even when opened directly by the application. <db:emphasis>Qt Designer</db:emphasis> shows the plugin libraries in its <db:emphasis role="bold">Help|About Plugins</db:emphasis> dialog, but no plugins are listed under each of them.</db:para>
</db:td>
<db:td>
<db:para>The application and its plugins are built in different modes.</db:para>
</db:td>
<db:td>
<db:para>Either share the same build information or build the plugins in both debug and release modes by appending the <db:code>debug_and_release</db:code> to the <db:link xlink:href="qmake-variable-reference.xml#config">CONFIG</db:link> variable in each of their project files.</db:para>
</db:td>
</db:tr>
</db:informaltable>
<db:para>You can also use the <db:code>QT_DEBUG_PLUGINS</db:code> environment variable to obtain diagnostic information from Qt about each plugin it tries to load. Set this variable to a non-zero value in the environment from which your application is launched.</db:para>
</db:section>
</db:article>
