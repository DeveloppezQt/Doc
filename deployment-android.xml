<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en">
<db:info>
<db:title>Deploying an Application on Android</db:title>
<db:productname>QtDoc</db:productname>
<db:edition>Qt 5.8.0 Reference Documentation</db:edition>
<db:titleabbrev>Qt Reference Documentation</db:titleabbrev>
<db:abstract>
<db:para>Qt Reference Documentation.</db:para></db:abstract>
<db:pubdate>2025-06-29</db:pubdate>
<db:date>2025-06-29</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:para><db:emphasis role="bold">&lt;Unknown command&gt;<db:code>contentspage</db:code></db:emphasis>Deploying Qt Applications</db:para>
<db:para>This article gives a technical description of the steps required to take any given Qt application and deploy it to an Android device (or market place).</db:para>
<db:para>It is recommended that you use the <db:link xlink:href="deployment-android.xml#androiddeployqt">androiddeployqt deployment tool</db:link> or Qt Creator to automate this work rather than perform the steps manually. The following information will give you a technical insight into the structure of the resulting Android application which is not normally required just to write an application.</db:para>
<db:section xml:id="the-apk-package">
<db:title>The APK Package</db:title>
<db:para>Applications on Android are packaged in a specially structured type of ZIP file called <db:code>APK</db:code>. When you build a Qt application using <db:code>qmake</db:code> and <db:code>make</db:code>, the result will be a binary file which is built with the correct compiler and flags to be usable on an Android device with the target architecture.</db:para>
<db:para>In order to turn this into a runnable application, it has to be put into a special directory structure with some other files and packaged into an APK package.</db:para>
</db:section>
<db:section xml:id="package-template">
<db:title>Package Template</db:title>
<db:para>A template for the other sources of an APK package is contained in <db:code>$QTDIR/src/android/java</db:code>. The first step of making an APK is to copy these files into an empty directory. In this guide, we'll refer to this build directory as <db:code>$BUILD_TARGET</db:code>.</db:para>
<db:para>We also need to make sure the application binary is copied into the package. This can be achieved by using the following command after running qmake on your application's project file:</db:para>
<db:programlisting language="cpp">make install INSTALL_ROOT=$BUILD_TARGET
</db:programlisting>
<db:para>It will copy the application binary and any other installation requirements into the packaging directory.</db:para>
<db:para>The packaging directory will now consist of the following parts:</db:para>
<db:section xml:id="androidmanifest-xml">
<db:title>AndroidManifest.xml</db:title>
<db:para>The <db:code>AndroidManifest.xml</db:code> file gives detailed meta-information about your application. This information is used for several things. It is used by the target device to decide which features to enable, the default orientation of the application, and so on. In addition, it's used by the market place for information on the version code, device support, package name, and lots more.</db:para>
<db:para>For more information about general capabilities of and requirements for the <db:code>AndroidManifest.xml</db:code> file, please refer to the <db:link xlink:href="http://developer.android.com/guide/topics/manifest/manifest-intro.html">Android documentation on this topic</db:link>.</db:para>
<db:para>There are some special variables recognized by Qt which can be placed inside the manifest:</db:para>
<db:itemizedlist>
<db:listitem>
<db:para><db:code>android.app.use_local_qt_libs</db:code>: If this is set to <db:code>1</db:code>, Qt libraries are expected to be found on the target device. If it is <db:code>0</db:code>, then libraries must be requested from the <db:emphasis role="bold">Ministro</db:emphasis> service.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>android.app.bundle_local_qt_libs</db:code>: If set to <db:code>1</db:code>, the Qt libraries are expected to be bundled as part of the <db:code>APK</db:code>. If set to <db:code>0</db:code>, they are expected to be found in the <db:code>/data/local/tmp/qt</db:code> folder on the target device.</db:para>
<db:note>
<db:para>If <db:code>use_local_qt_libs</db:code> is 0, then this variable has no effect, since libraries are then requested through Ministro instead.</db:para>
</db:note>
</db:listitem>
</db:itemizedlist>
<db:para>Other variables in the manifest refer to resources, and more information about these can be found in the <db:link xlink:href="qmake-variable-reference.xml#resources">documentation for the resources</db:link> below.</db:para>
</db:section>
<db:section xml:id="java-code">
<db:title>Java Code</db:title>
<db:para>Under <db:code>$BUILD_TARGET/src</db:code> are the files comprising the Java code of the Android application. The regular Android application launcher is a Java process, so Qt applications have a Java-based entry point. The code in here will load the required Qt libraries, based on the meta-information given in other files in the template. The code supports all the three deployment mechanisms which are supported in Qt Creator and <db:code>androiddeployqt</db:code>: <db:emphasis>Bundled</db:emphasis>, <db:emphasis>Ministro</db:emphasis> and <db:emphasis>Debug</db:emphasis>.</db:para>
<db:para>After loading the libraries, the Java code will call into the application's native <db:code>main()</db:code> function on a new thread and the application will launch. At this point, the Java code in the template is used to delegate events from Android into Qt.</db:para>
<db:para>One thing to note about the files in this directory is that they can contain code specific to certain Android versions. Based on the minimum required Android API level of your application it might be necessary to remove some of this code. This is done automatically by <db:code>androiddeployqt</db:code> and Qt Creator during packaging.</db:para>
<db:para>For example, lets say the code contains the following:</db:para>
<db:programlisting language="cpp">//@ANDROID-21
    @Override
    public void onActivityReenter(int resultCode, Intent data)
    {
        // Do something
        return super.onActivityReenter(resultCode, data);
    }
//@ANDROID-21
    </db:programlisting>
<db:para>If your minimum Android API level is 20 or lower, then the code should be removed before building, since it's not a supported API on Android API level 20. However, if your minimum API level is 21 or higher, it should be left in.</db:para>
</db:section>
<db:section xml:id="resources">
<db:title>Resources</db:title>
<db:para>Under the <db:code>res/</db:code> folder in the <db:code>$BUILD_TARGET</db:code> are Android resources that can be accessed from the <db:code>AndroidManifest.xml</db:code> and Java code of your application. A typical example of resources which should be placed here are the icon files used by the application launcher to represent your application.</db:para>
<db:para>In Qt, some translations used for the Ministro service and some files with meta-information are in the default resources of the application.</db:para>
<db:section xml:id="res-values-libs-xml">
<db:title>res/values/libs.xml</db:title>
<db:para>One of the files containing meta information about the deployment of the application is <db:code>libs.xml</db:code>. It consists of the following values:</db:para>
<db:itemizedlist>
<db:listitem>
<db:para><db:code>qt_sources</db:code>: The URL of one or more Ministro repositories that contain the necessary Qt libraries. This is used when the Ministro deployment mechanism is active. Read the <db:link xlink:href="http://necessitas.kde.org/necessitas/ministro.php">Ministro documentation</db:link> for more information about such repositories.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>repository</db:code>: The Ministro repository to use at the given URL. This is used when the Ministro deployment mechanism is active.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>bundled_libs</db:code>: Libraries in the APK's library folder which should be loaded on start-up. Library names should be specified without the <db:code>lib</db:code> prefix and <db:code>.so</db:code> suffix.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>qt_libs</db:code>: Qt libraries which should be loaded on start-up. When bundled deployment is used, these are expected to be found inside the <db:code>APK</db:code>'s library folder. When Ministro deployment is in use, they are requested from the Ministro service on the device. And when debugging deployment is in use, they are loaded from the <db:code>/data/local/tmp/qt</db:code> directory on the target device.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>bundled_in_lib</db:code>: List of plugins which are bundled in the <db:code>APK</db:code>'s library folder. This is only used when the bundling deployment mechanism is active. Qt's plugin system requires plugins to be placed in a special directory structure which contains information about the plugin category. The library folder in the APK does not support such a directory structure, so the bundled_in_lib array contains the information lost when the directory structure is flattened. Each item is a pair of paths, separated by a colon. The first of the pair is the file name of the file bundled inside the <db:code>APK</db:code>'s library folder. The second of the pair is the original path of the file, relative to the Qt installation.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>bundled_in_assets</db:code>: List of other types of Qt files which are bundled inside the <db:code>APK</db:code>'s asset folder. This value is only used when the bundling deployment mechanism is active. The format of the items is the same as for the <db:code>bundled_in_lib array</db:code>. The difference is that the first of the pairs refers to the path of a file inside the <db:code>assets</db:code> directory of the application instead of the library directory. This array is typically used for bundling QML imports, which also require a special directory structure to be used inside Qt.</db:para>
</db:listitem>
</db:itemizedlist>
</db:section>
<db:section xml:id="res-values-strings-xml">
<db:title>res/values/strings.xml</db:title>
<db:para>The <db:code>strings.xml</db:code> file contains some strings used by the <db:code>AndroidManifest.xml</db:code> and by the deployment mechanisms, as well as some strings used when loading the Ministro service.</db:para>
<db:para>In particular, the application name and the name of the application binary can be specified here. There are also strings that contain additional libraries that should be loaded and <db:code>JAR</db:code> files which should be included in the class path. The latter is only used for deployment with Ministro or debug deployment.</db:para>
</db:section>
</db:section>
<db:section xml:id="libraries">
<db:title>Libraries</db:title>
<db:para>Under <db:code>libs</db:code> in the package directory, it's possible to place libraries that should be included in the application bundle. <db:code>JAR</db:code> libraries should be placed directly under <db:code>libs/</db:code>, while shared libraries should be put in a subdirectory suitably named after the target architecture of the libraries.</db:para>
<db:para>For deployment that bundles Qt in the <db:code>APK</db:code>, the Qt <db:code>JAR</db:code> files that are suffixed with <db:code>&quot;bundled&quot;</db:code> should be put into the libs directory. It is also required that the necessary shared libraries and plugins are placed in the appropriate subdirectory of libs.</db:para>
</db:section>
</db:section>
<db:section xml:id="building-the-android-application-package">
<db:title>Building the Android Application Package</db:title>
<db:para>Once all the pieces are in place, a few steps are required to build the application package. First, a build script needs to be generated. This is done using the <db:code>android</db:code> tool which is part of the Google Android SDK.</db:para>
<db:para>Example:</db:para>
<db:programlisting language="cpp">% android update project --path $BUILD_TARGET --target android-16 --name QtApp
</db:programlisting>
<db:para>This example will create build files in <db:code>$BUILD_TARGET</db:code> for an <db:code>APK</db:code> named <db:code>QtApp</db:code>. The Java code will be compiled against the <db:code>android-16</db:code> platform.</db:para>
<db:para>The project can then be built using the ant tool. If a release package is built it can be signed and aligned using <db:code>jarsigner</db:code> and <db:code>zipalign</db:code>.</db:para>
</db:section>
<db:section xml:id="androiddeployqt">
<db:title>androiddeployqt</db:title>
<db:para>Building an application package is complex, so Qt comes with a tool which handles the work for you. The steps described in this document so far are handled automatically by the tool.</db:para>
<db:section xml:id="required-steps-before-running-androiddeployqt">
<db:title>Required Steps Before Running androiddeployqt</db:title>
<db:para>Before running the tool, you need run <db:code>qmake</db:code> and <db:code>make</db:code> your project. Running <db:code>qmake</db:code> creates the <db:code>Makefile</db:code>, and it will also generate a <db:code>JSON</db:code> file containing important settings used by <db:code>androiddeployqt</db:code>.</db:para>
<db:para>You should then install the application binary (and any other requirements) into the library folder of the <db:code>APK</db:code>. If <db:code>$BUILD_TARGET</db:code> is your build directory (the first time you do this, the directory should be empty at this point), then you can install the binary with the following command:</db:para>
<db:programlisting language="cpp">% make install INSTALL_ROOT=$BUILD_TARGET
</db:programlisting>
</db:section>
<db:section xml:id="command-line-arguments">
<db:title>Command Line Arguments</db:title>
<db:para>The only required command line argument when running the tool is <db:code>--output</db:code>. This should be set to <db:code>$BUILD_TARGET</db:code>, that is: the build directory where you installed your application binary.</db:para>
<db:para>Other command line arguments are optional but useful. Here's a quick overview. More information is available by passing the <db:code>--help</db:code> argument to androiddeployqt.</db:para>
<db:itemizedlist>
<db:listitem>
<db:para><db:code>--input &lt;file name&gt;</db:code>: This allows you to specify the <db:code>JSON</db:code> file generated by <db:code>qmake</db:code>. By default, <db:code>androiddeployqt</db:code> will try to guess the file name based on the current working directory.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--deployment &lt;mechanism&gt;</db:code>: Specify this to pick a different deployment mechanism than the default.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--install</db:code>: Specify this to install the finished package on the target device or emulator. Note that if a previous version of the package is already installed, it will be uninstalled first, removing any data it might have stored locally.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--device &lt;ID&gt;</db:code>: Specify the ID of the target device or emulator as reported by the <db:code>adb</db:code> tool. If an ID is specified, it will be passed to all calls to <db:code>adb</db:code>. If it is unspecified, no particular device or emulator will be requested by <db:code>adb</db:code>, causing it to pick a default instead.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--android-platform &lt;platform&gt;</db:code>: The SDK platform used for building the Java code of the application. By default, the latest available platform is used.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--ant &lt;path&gt;</db:code>: Specify the path to the <db:code>ant</db:code> executable. If this is unspecified, <db:code>androiddeployqt</db:code> will attempt to detect it on the <db:code>PATH</db:code>.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--release</db:code>: Specify this to create a release package instead of a debug package. With no other arguments, release packages are unsigned and cannot be installed to any device before they have been signed by a private key.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--sign &lt;url&gt; &lt;alias&gt;</db:code>: Sign the resulting package. Specifying this also implies <db:code>--release</db:code>. The URL of the keystore file and the alias of the key have to be specified. In addition, there are a number of options that can be specified which are passed through to the <db:code>jarsigner</db:code> tool. Pass <db:code>--help</db:code> to <db:code>androiddeployqt</db:code> for more information about these.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--jdk &lt;path&gt;</db:code>: Specify the path to the Java Development Kit. This is only required for signing packages, as it is only used for finding the <db:code>jarsigner</db:code> tool. If it is unspecified, then <db:code>androiddeployqt</db:code> will attempt to detect <db:code>jarsigner</db:code>, either using the <db:code>JAVA_HOME</db:code> environment variable, or on the <db:code>PATH</db:code>.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>--verbose</db:code>: Specify this to output more information about what <db:code>androiddeployqt</db:code> is doing.</db:para>
</db:listitem>
</db:itemizedlist>
</db:section>
</db:section>
<db:section xml:id="dependencies-detection">
<db:title>Dependencies Detection</db:title>
<db:para>Qt comes with a number of plugins which are loaded at run-time when they are needed. These can handle anything from connecting to SQL databases to loading specific image formats. Detecting plugin dependencies is impossible as the plugins are loaded at run-time, but androiddeployqt tries to guess such dependencies based on the Qt dependencies of your application. If the plugin has any Qt dependencies which are not also dependencies of your application, it will not be included by default. For instance, in order to ensure that the SVG image format plugin is included, you will need to add <db:code>QT += svg</db:code> to your <db:code>.pro</db:code> file so that the <db:link xlink:href="qtsvg-index.xml">Qt SVG</db:link> module becomes a dependency of your application.</db:para>
<db:para>If you are wondering why a particular plugin is not included automatically, you can run androiddeployqt with the <db:code>--verbose</db:code> option to get the list of missing dependencies for each excluded plugin. You can achieve the same in Qt Creator by ticking the <db:emphasis role="bold">Verbose output</db:emphasis> check box in the <db:emphasis role="bold">Deployment configurations</db:emphasis>. This is located in the <db:emphasis role="bold">Run</db:emphasis> tab of your <db:emphasis role="bold">Projects</db:emphasis> settings.</db:para>
<db:para>It's also possible to manually specify the dependencies of your application. See the documentation for the <db:code>ANDROID_DEPLOYMENT_DEPENDENCIES</db:code> qmake variable below.</db:para>
</db:section>
<db:section xml:id="android-specific-qmake-variables">
<db:title>Android-specific qmake Variables</db:title>
<db:para>Unless the project has special requirements such as third party libraries, it should be possible to run <db:code>androiddeployqt</db:code> on it with no modifications and get a working Qt for Android application as a result.</db:para>
<db:para>However, there are a set of <db:code>qmake</db:code> variables that can be used to tailor your package. At some point during development, you will most likely want to look into these variables, as they will e.g. allow you to set the name of your application as it appears in the application menu on devices.</db:para>
<db:para>Here is a list of some variables that are particularly interesting when making Android applications:</db:para>
<db:itemizedlist>
<db:listitem>
<db:para><db:code>ANDROID_DEPLOYMENT_DEPENDENCIES</db:code>: By default, <db:code>androiddeployqt</db:code> will detect the dependencies of your application. But since run-time usage of plugins cannot be detected, there could be false positives, as your application will depend on any plugins that are <db:emphasis>potential</db:emphasis> dependencies. If you want to minimize the size of your <db:code>APK</db:code>, it's possible to override the automatic detection using the <db:code>ANDROID_DEPLOYMENT_DEPENDENCIES</db:code> variable. This should contain a list of all Qt files which need to be included, with paths relative to the Qt install root. Note that only the Qt files specified here will be included. Failing to include the correct files can result in crashes. It's also important to make sure the files are listed in the correct loading order. This variable provides a way to override the automatic detection entirely, so if a library is listed before its dependencies, it will fail to load on some devices.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>ANDROID_PACKAGE_SOURCE_DIR</db:code>: This variable can be used to specify a directory where additions and modifications can be made to the default Android package template. The <db:code>androiddeployqt</db:code> tool will copy the application template from Qt into the build directory, and then it will copy the contents of the <db:code>ANDROID_PACKAGE_SOURCE_DIR</db:code> on top of this, overwriting any existing files. The update step where parts of the source files are modified automatically to reflect your other settings is then run on the resulting merged package. If you, for instance, want to make a custom <db:code>AndroidManifest.xml</db:code> for your application, then place this directly into the folder specified in this variable. You can also add custom Java files in <db:code>ANDROID_PACKAGE_SOURCE_DIR/src</db:code>.</db:para>
<db:note>
<db:para>When adding custom versions of the build files (like strings.xml, libs.xml, AndroidManifest.xml, etc.) to your project, make sure you copy them from the package template, which is located in <db:code>$QT/src/android/java</db:code>. You should never copy any files from the build directory, as these files have been altered to match the current build settings.</db:para>
</db:note>
</db:listitem>
<db:listitem>
<db:para><db:code>ANDROID_EXTRA_LIBS</db:code>: A list of external libraries that will be copied into your application's library folder and loaded on start-up. This can be used, for instance, to enable OpenSSL in your application. Simply set the paths to the required <db:code>libssl.so</db:code> and <db:code>libcrypto.so</db:code> libraries here and OpenSSL should be enabled automatically.</db:para>
</db:listitem>
<db:listitem>
<db:para><db:code>ANDROID_EXTRA_PLUGINS</db:code>: This variable can be used to specify different resources that your project has to bundle but cannot be delivered through the assets system, such as qml plugins. When using this variable, <db:code>androiddeployqt</db:code> will make sure everything is packaged and deployed properly.</db:para>
</db:listitem>
</db:itemizedlist>
</db:section>
<db:section xml:id="deployment-in-qt-creator">
<db:title>Deployment in Qt Creator</db:title>
<db:para>Qt Creator will run the <db:code>androiddeployqt</db:code> tool for you, and provides easy and intuitive user interfaces to specify many of the options. For more information, see <db:link xlink:href="http://doc.qt.io/qtcreator/creator-deploying-android.html">the Qt Creator documentation</db:link>.</db:para>
</db:section>
</db:article>
