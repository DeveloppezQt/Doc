<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en">
<db:info>
<db:title>Deploying an Application on Android</db:title>
<db:productname>QtDoc</db:productname>
<db:edition>Qt 6.7.2 Reference Documentation</db:edition>
<db:titleabbrev>Qt Reference Documentation</db:titleabbrev>
<db:extendedlink xlink:type="extended"><db:link xlink:to="porting-to-android.xml" xlink:type="arc" xlink:arcrole="prev" xlink:title="Porting to Android"/></db:extendedlink>
<db:extendedlink xlink:type="extended"><db:link xlink:to="android-openssl-support.xml" xlink:type="arc" xlink:arcrole="next" xlink:title="Adding OpenSSL Support for Android"/></db:extendedlink>
<db:abstract>
<db:para>The technical steps required to deploy a Qt application on Android.</db:para>
</db:abstract>
<db:pubdate>2024-12-27</db:pubdate>
<db:date>2024-12-27</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:para>This article describes the technical steps required to deploy a Qt application to an Android device.</db:para>
<db:section xml:id="android-application-bundle">
<db:title>Android Application Bundle</db:title>
<db:para>Applications on Android can be packaged in two ways; either as an Application Package (APK) or Android App Bundle (AAB). Both are a type of ZIP file that follows a predefined directory structure. The difference between the two is that APK files can be deployed and executed on a device, whereas AAB is intended to be interpreted by the Google Play store and is used to generate APK files for different device architectures and form factors.</db:para>
<db:para>For testing the application locally, the APK format is appropriate, as this can be installed and run directly on the device. For distribution to the Google Play store, it is recommended to use AAB instead, which has a similar layout. The added convenience of AAB is that you can include all target ABIs in the same bundle without increasing the size of the actual package downloaded by your users. When using AAB, the Google Play store generates optimized APK packages for the devices issuing the download request and automatically signs them with your publisher key. For more information, see <db:link xlink:href="android-publishing-to-googleplay.xml">Publishing to Google Play</db:link>.</db:para>
<db:para>For more information on the AAB format, see the <db:link xlink:href="https://developer.android.com/guide/app-bundle">Android App Bundles</db:link>.</db:para>
<db:para>In either case, the application bundle is generated from a specific directory structure that contains the shared libraries of your project and Qt's dependencies needed by your application. In addition, any assets, resources, jar files or project Java code is compiled and included.</db:para>
<db:section xml:id="generating-the-application-bundle">
<db:title>Generating the Application Bundle</db:title>
<db:para>It is recommended to use Qt Creator to <db:link xlink:href="https://doc.qt.io/qtcreator/creator-deploying-android.html">deploy Qt for Android apps</db:link>. Otherwise, the same can be done through the command line with the help of CMake or qmake. For more information, see <db:link xlink:href="android-building-projects-from-commandline.xml">Building Qt for Android Projects from Command Line</db:link>.</db:para>
<db:para>The packaging and deployment process is handled by CMake or qmake which, under the hood, use the <db:link xlink:href="android-deploy-qt-tool.xml#androiddeployqt">androiddeployqt</db:link> tool to manage the specifics of building and deploying an Android app. Qt Creator also uses the same tool.</db:para>
</db:section>
</db:section>
<db:section xml:id="extending-qt-with-android-facilities">
<db:title>Extending Qt with Android Facilities</db:title>
<db:anchor xml:id="android-package-templates"/>
<db:para>By default, Qt for Android does most of the heavy lifting to get an Android app up and running, having the most useful APIs available directly from Qt, or using <db:link xlink:href="qjniobject.xml">QJniObject</db:link> to invoke not readily available APIs. The same is valid for CMake, which handles the various build and deployment cases. However, in some other cases, it might be required to have the full power of native Android facilities, such as writing Java/kotlin code or using Android resource management. Qt allows that by allowing the user to extend the set of templates.</db:para>
<db:para>The default templates used by Qt are found under the Qt for Android install path, for example, under ~/Qt/&lt;version&gt;/android_&lt;abi&gt;/src/android/templates for Unix. To use those templates, it's possible to have Qt Creator copy them to your project, see <db:link xlink:href="http://doc.qt.io/qtcreator/creator-deploying-android.html#editing-manifest-files">Qt Creator: Editing Manifest Files</db:link>. Or you can manually copy them over to your project source under a android sub-directory. Then make sure to define the following property in your CMakeLists.txt:</db:para>
<db:programlisting language="cpp" role="bad">set_property(TARGET target_name PROPERTY QT_ANDROID_PACKAGE_SOURCE_DIR
          &quot;${CMAKE_CURRENT_SOURCE_DIR}/android&quot;)
</db:programlisting>
<db:para>Or for qmake in your pro file:</db:para>
<db:programlisting language="cpp" role="bad">android: ANDROID_PACKAGE_SOURCE_DIR = $$PWD/android
</db:programlisting>
<db:note>
<db:para>When using Qt Creator, files under this path are by default visible under the project files if CMake is used. To achieve the same behavior with qmake, add those file paths manually to your project using <db:link xlink:href="qmake-variable-reference.xml#distfiles">DISTFILES</db:link>.</db:para>
</db:note>
<db:para>The build process copies the templates to the build directory &lt;build_path&gt;/android-build from your project or from the default templates if the project didn't set QT_ANDROID_PACKAGE_SOURCE_DIR. After that, the directory &lt;build_path&gt;/android-build acts as the packaging directory. The application bundle is created from there using Gradle.</db:para>
<db:para>Now, let's go through the different parts that the user can work with after extending the default templates.</db:para>
<db:section xml:id="androidmanifest-xml">
<db:title>AndroidManifest.xml</db:title>
<db:para>The AndroidManifest.xml file gives detailed meta-information about your application. This information is used to customize your application bundle, and it's used by the device to decide which features to enable, such as the default orientation of the application. In addition, it's used by the Google Play Store for information on the version code, device support, package name, and lots more. The Android Manifest is also used to define <db:link xlink:href="android-services.xml">Android Services</db:link> and custom <db:link xlink:href="https://developer.android.com/guide/components/activities/intro-activities">Android Activities</db:link>.</db:para>
<db:para>For more information about the AndroidManifest.xml, see <db:link xlink:href="android-manifest-file-configuration.xml">Android Manifest file documentation</db:link>, and Qt Creator's page for <db:link xlink:href="http://doc.qt.io/qtcreator/creator-deploying-android.html#editing-manifest-files">Qt Creator: Editing Manifest Files</db:link>.</db:para>
</db:section>
<db:section xml:id="gradle-files">
<db:title>Gradle Files</db:title>
<db:para><db:link xlink:href="http://www.gradle.org">Gradle</db:link> is used to build Android packages. Qt includes two sets of Gradle related files:</db:para>
<db:itemizedlist>
<db:listitem>
<db:para>Gradle wrapper, which is used to download a specific version of Gradle itself, and the build scripts that are used to invoke the Gralde build. These files come with Qt under for example ~/Qt/&lt;version&gt;/android_&lt;abi&gt;/src/3rdparty/gradle.</db:para>
<db:note>
<db:para>Usually, using the same Gradle version that Qt comes with is recommended. However, if you wish to use a different Gradle version, you can modify the Gradle wrapper gradle-wrapper.properties and set it to the Gradle version you want to use.</db:para>
</db:note>
</db:listitem>
<db:listitem>
<db:para>The Gradle configuration file build.gradle, which is under the <db:link xlink:href="deployment-android.xml#extending-qt-with-android-facilities">Android Templates</db:link>. This file is required by Gradle and can be used to customize the build. It can be used to set the build target or minimum API or add library dependencies. It can also be used to set the <db:link xlink:href="https://developer.android.com/build/releases/gradle-plugin">Android Gradle plugin</db:link>, which is a required Gradle dependency for building Android apps. An example of this is:</db:para>
<db:programlisting language="cpp" role="bad">buildscript {
    ...
    dependencies {
        classpath 'com.android.tools.build:gradle:7.4.1'
    }
}
</db:programlisting>
<db:para>For more information, see <db:link xlink:href="https://developer.android.com/studio/build#build-files">Android: Build Configuration Files</db:link>.</db:para>
</db:listitem>
</db:itemizedlist>
</db:section>
<db:section xml:id="java-kotlin-code">
<db:title>Java/Kotlin Code</db:title>
<db:para>To include any Java/Kotlin code to target some APIs that Qt doesn't cover or for some other reason, place any code under the path &lt;QT_ANDROID_PACKAGE_SOURCE_DIR&gt;/src/. For example, you can call Java methods from within Qt code. For an example, see <db:link xlink:href="qtcore-platform-androidnotifier-example.xml">Qt Android Notifier Example</db:link>.</db:para>
</db:section>
<db:section xml:id="resources">
<db:title>Resources</db:title>
<db:para>Android allows the addition of resource files such as icons, images, strings, colors, and so on. Those resources can be referenced directly from Java/Kotlin code or the manifest file. Any such files can be added to your project under &lt;QT_ANDROID_PACKAGE_SOURCE_DIR&gt;/res/. For example, app icons can be added under res/drawable/icon.png.</db:para>
<db:para>For more information, see <db:link xlink:href="https://developer.android.com/guide/topics/resources/providing-resources">Android: App resources overview</db:link>.</db:para>
<db:section xml:id="qt-internal-resources">
<db:title>Qt Internal Resources</db:title>
<db:para>By default, Qt packages a few resources that are needed for the apps to run properly. For example, on Unix, these resources are found under ~/Qt/&lt;version&gt;/android_&lt;abi&gt;/src/android/templates/res.</db:para>
<db:section xml:id="strings-xml">
<db:title>strings.xml</db:title>
<db:para>This file can be found at res/values/strings.xml. This file contains strings the Qt library uses to reference message translations for various languages.</db:para>
</db:section>
<db:section xml:id="libs-xml">
<db:title>libs.xml</db:title>
<db:para>This file can be found at res/values/libs.xml. It is used purely to manage deployment information of the Qt libraries, and it's not recommended to be manually modified.</db:para>
</db:section>
</db:section>
</db:section>
<db:section xml:id="android-assets">
<db:title>Android Assets</db:title>
<db:para>For more information on managing Android assets, see <db:link xlink:href="porting-to-android.xml">Adding resources</db:link>.</db:para>
</db:section>
<db:section xml:id="android-libraries">
<db:title>Android Libraries</db:title>
<db:para>For more information on using third-party libraries with your Qt project, see <db:link xlink:href="android-3rdparty-libs.xml">Including a Library to an Android Project</db:link>.</db:para>
</db:section>
</db:section>
</db:article>
