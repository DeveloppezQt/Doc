<?xml version="1.0" encoding="UTF-8"?>
<db:article xmlns:db="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.2" xml:lang="en_US">
<db:info>
<db:title>Chapter 2: Connecting to C++ Methods and Signals</db:title>
<db:productname>QtQml</db:productname>
<db:edition>Qt 5.2.1 Reference Documentation</db:edition>
<db:titleabbrev>Qt QML Reference Documentation</db:titleabbrev>
<db:abstract>
<db:para>Qt QML Reference Documentation.</db:para></db:abstract>
<db:pubdate>2025-06-29</db:pubdate>
<db:date>2025-06-29</db:date>
<db:authorgroup>
<db:author>
<db:orgname class="corporation">The Qt Company Ltd.</db:orgname>
</db:author>
</db:authorgroup>
</db:info>
<db:para>Suppose we want <db:code>PieChart</db:code> to have a &quot;clearChart()&quot; method that erases the chart and then emits a &quot;chartCleared&quot; signal. Our <db:code>app.qml</db:code> would be able to call <db:code>clearChart()</db:code> and receive <db:code>chartCleared()</db:code> signals like this:</db:para>
<db:programlisting language="qml">import Charts 1.0
import QtQuick 2.0

Item {
    width: 300; height: 200

    PieChart {
        id: aPieChart
        anchors.centerIn: parent
        width: 100; height: 100
        color: &quot;red&quot;

        onChartCleared: console.log(&quot;The chart has been cleared&quot;)
    }

    MouseArea {
        anchors.fill: parent
        onClicked: aPieChart.clearChart()
    }

    Text {
        anchors { bottom: parent.bottom; horizontalCenter: parent.horizontalCenter; bottomMargin: 20 }
        text: &quot;Click anywhere to clear the chart&quot;
    }
}
</db:programlisting>
<db:mediaobject>
<db:imageobject>
<db:imagedata fileref="images/extending-tutorial-chapter2.png"/>
</db:imageobject>
</db:mediaobject>
<db:para>To do this, we add a <db:code>clearChart()</db:code> method and a <db:code>chartCleared()</db:code> signal to our C++ class:</db:para>
<db:programlisting language="cpp">class PieChart : public QQuickPaintedItem
{
    ...
public:
    ...
    Q_INVOKABLE void clearChart();

signals:
    void chartCleared();
    ...
};
</db:programlisting>
<db:para>The use of <db:link xlink:href="qobject.xml#Q_INVOKABLE">Q_INVOKABLE</db:link> makes the <db:code>clearChart()</db:code> method available to the Qt Meta-Object system, and in turn, to QML. Note that it could have been declared as as a Qt slot instead of using <db:link xlink:href="qobject.xml#Q_INVOKABLE">Q_INVOKABLE</db:link>, as slots are also callable from QML. Both of these approaches are valid.</db:para>
<db:para>The <db:code>clearChart()</db:code> method simply changes the color to <db:link xlink:href="qt.xml#GlobalColor-enum">Qt::transparent</db:link>, repaints the chart, then emits the <db:code>chartCleared()</db:code> signal:</db:para>
<db:programlisting language="cpp">void PieChart::clearChart()
{
    setColor(QColor(Qt::transparent));
    update();

    emit chartCleared();
}
</db:programlisting>
<db:para>Now when we run the application and click the window, the pie chart disappears, and the application outputs:</db:para>
<db:programlisting language="cpp">The chart has been cleared
</db:programlisting>
<db:para>Try out the example yourself with the updated code in Qt's <db:code>examples/qml/tutorials/extending/chapter2-methods</db:code> directory.</db:para>
<db:section>
<db:title>List of Files</db:title>
<db:para>Files:</db:para>
<db:section>
<db:title>List of Files</db:title>
<db:itemizedlist>
<db:listitem>
<db:para><db:link xlink:href="tutorials/extending/chapter2-methods/app.qml">tutorials/extending/chapter2-methods/app.qml</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="tutorials/extending/chapter2-methods/chapter2-methods.pro">tutorials/extending/chapter2-methods/chapter2-methods.pro</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="tutorials/extending/chapter2-methods/chapter2-methods.qrc">tutorials/extending/chapter2-methods/chapter2-methods.qrc</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="tutorials/extending/chapter2-methods/main.cpp">tutorials/extending/chapter2-methods/main.cpp</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="tutorials/extending/chapter2-methods/piechart.cpp">tutorials/extending/chapter2-methods/piechart.cpp</db:link></db:para></db:listitem>
<db:listitem>
<db:para><db:link xlink:href="tutorials/extending/chapter2-methods/piechart.h">tutorials/extending/chapter2-methods/piechart.h</db:link></db:para></db:listitem>
</db:itemizedlist>
</db:section>
</db:section></db:article>
